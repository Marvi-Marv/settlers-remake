<!DOCTYPE building SYSTEM "../building.dtd">
<building worker="FISHERMAN" workradius="30">
	<ground groundtype="GRASS"/>
	<ground groundtype="EARTH"/>
	<ground groundtype="FLATTENED"/>

	<blocked dx="-1" dy="1" block="true" />
	<blocked dx="-1" dy="0" block="true" />
	<blocked dx="-1" dy="-1" block="true" />
	<blocked dx="-1" dy="-2" block="true" />
	<blocked dx="0" dy="-2" block="true" />
	<blocked dx="1" dy="-1" block="true" />
	<blocked dx="1" dy="1" block="true" />
	<blocked dx="1" dy="0" block="true" />
	<blocked dx="0" dy="-1" block="true" />
	<blocked dx="0" dy="0" block="true" />
	<blocked dx="0" dy="1" block="true" />
	<blocked dx="0" dy="2" block="true" />
	<blocked dx="1" dy="3" block="true" />
	<blocked dx="1" dy="2" block="true" />
	<blocked dx="2" dy="3" block="true" />
	<blocked dx="2" dy="0" block="true" />
	<blocked dx="-1" dy="2" block="true" />
	<blocked dx="2" dy="1" block="true" />
	<blocked dx="3" dy="4" block="true" />
	<blocked dx="2" dy="4" block="true" />
	<blocked dx="1" dy="4" block="true" />
	<blocked dx="0" dy="4" block="true" />
	<blocked dx="0" dy="3" block="true" />
	<blocked dx="-2" dy="1" block="true" />
	<blocked dx="-2" dy="0" block="true" />
	<blocked dx="-2" dy="-1" block="true" />
	<blocked dx="-2" dy="-2" block="true" />
	<blocked dx="-2" dy="-3" block="true" />
	<blocked dx="-1" dy="-3" block="true" />
	<blocked dx="0" dy="-3" block="true" />
	<blocked dx="2" dy="-1" block="true" />
	<blocked dx="3" dy="1" block="true" />
	<blocked dx="1" dy="-2" block="true" />
	<blocked dx="-3" dy="-3" block="true" />
	<blocked dx="-3" dy="-2" block="true" />
	<blocked dx="-3" dy="-1" block="true" />
	<blocked dx="-1" dy="3" block="true" />
	<blocked dx="-3" dy="-4" block="true" />
	<blocked dx="-2" dy="-4" block="true" />
	<blocked dx="-1" dy="-4" block="true" />
	<blocked dx="-3" dy="0" block="true" />
	<blocked dx="3" dy="2" block="true" />
	<blocked dx="1" dy="5" block="true" />
	<blocked dx="2" dy="5" block="true" />
	<blocked dx="2" dy="6" block="true" />
	<blocked dx="3" dy="5" block="true" />
	<blocked dx="3" dy="6" block="true" />
	<blocked dx="2" dy="2" block="true" />

	<blocked dx="4" dy="4" block="false" />
	<blocked dx="4" dy="2" block="false" />
	<blocked dx="3" dy="0" block="false" />
	<blocked dx="2" dy="-2" block="false" />
	<blocked dx="1" dy="-3" block="false" />
	<blocked dx="0" dy="-4" block="false" />
	<blocked dx="-1" dy="-5" block="false" />
	<blocked dx="-4" dy="-4" block="false" />
	<blocked dx="-4" dy="-3" block="false" />
	<blocked dx="-4" dy="-2" block="false" />
	<blocked dx="-4" dy="-1" block="false" />
	<blocked dx="-4" dy="0" block="false" />
	<blocked dx="-3" dy="1" block="false" />
	<blocked dx="-2" dy="2" block="false" />
	<blocked dx="0" dy="5" block="false" />
	<blocked dx="-1" dy="4" block="false" />
	<blocked dx="-2" dy="3" block="false" />
	<blocked dx="1" dy="6" block="false" />
	<blocked dx="4" dy="6" block="false" />
	<blocked dx="2" dy="7" block="false" />
	<blocked dx="3" dy="7" block="false" />
	<blocked dx="4" dy="7" block="false" />
	<blocked dx="-4" dy="-5" block="false" />
	<blocked dx="3" dy="3" block="false" />
	<blocked dx="-2" dy="-5" block="false" />
	<blocked dx="-3" dy="-5" block="false" />
	<blocked dx="4" dy="5" block="false" />
	<blocked dx="4" dy="3" block="false" />
	<blocked dx="5" dy="4" block="false" />
	<blocked dx="7" dy="5" block="false" />

	<door dx="3" dy="3" />

	<constructionStack dx="5" dy="4" material="PLANK" buildrequired="2" />
	<constructionStack dx="7" dy="5" material="STONE" buildrequired="3" />

	<offerStack dx="5" dy="4" material="FISH" />

	<bricklayer dx="-1" dy="4" direction="NORTH_EAST" />
	<bricklayer dx="-2" dy="2" direction="NORTH_EAST" />
	<bricklayer dx="4" dy="3" direction="NORTH_WEST" />
	<bricklayer dx="4" dy="5" direction="NORTH_WEST" />
	
	<flag dx="-1" dy="-3" />

	<buildmark dx="3" dy="5" />
	<buildmark dx="2" dy="5" />
	<buildmark dx="3" dy="0" />
	<buildmark dx="1" dy="-3" />
	<buildmark dx="-2" dy="-5" />
	<buildmark dx="-2" dy="0" />

	<image file="24" for="GUI" type="GUI" sequence="18" image="0"/>
    <image file="23" type="SETTLER" for="FINAL" image="0" sequence="20"/>
    <image file="23" type="SETTLER" for="BUILD" image="1" sequence="20"/>

	<startjob name="gohome"/>

	<!-- go home -->
	<job name="gohome" 			type="GO_TO" 					successjob="hide" 			failjob="gohome_wait" 	dx="3" dy="3"/>
	<!-- go home failed, retry -->
	<job name="gohome_wait" 	type="WAIT" 					successjob="gohome" 		failjob="gohome_wait" 	time="1.0"/>

	<!-- arrive at front door => hide -->
	<job name="hide" 			type="HIDE" 					successjob="reset" 			failjob="gohome_wait"/>
	<job name="reset" 			type="SET_MATERIAL"				successjob="wait_at_home" 	failjob="wait_at_home" 	material="NO_MATERIAL"/>

	<!-- wait some time -->
	<job name="wait_at_home" 	type="WAIT" 					successjob="check" 			failjob="wait_at_home" 	time="1.0"/>

	<job name="check" 			type="NOT_FULL" 				successjob="presearch" 		failjob="hide" 			dx="5" dy="4"/>

	<!-- show -->
	<job name="presearch" 		type="PRE_SEARCH_IN_AREA" 		successjob="show" 			failjob="wait_at_home" 	dx="3" dy="3" search="FISHABLE"/>
	<job name="show" 			type="SHOW" 					successjob="search_fish" 	failjob="hide" 			dx="3" dy="3"/>

	<!-- go search -->
	<job name="search_fish" 	type="FOLLOW_SEARCHED" 			successjob="look_at_fish" 	failjob="hide" 		/>

	<!-- fish it -->
	<job name="look_at_fish" 	type="LOOK_AT_SEARCHED"			successjob="try" 			failjob="gohome" 		direction="NORTH_WEST" search="FISHABLE"/>
	<job name="try"				type="TRY_TAKING_RESOURCE"		successjob="play_success1" 	failjob="play_fail1"		/>

	<!--  fail -->
	<job name="play_fail1" 		type="PLAY_ACTION1" 			successjob="play_fail2" 	failjob="gohome" 		time="1"/>
	<job name="play_fail2" 		type="PLAY_ACTION2" 			successjob="gohome" 		failjob="gohome" 		time="2"/>

	<!-- success -->
	<job name="play_success1"	type="PLAY_ACTION1" 			successjob="play_success2" 	failjob="gohome" 		time="1"/>
	<job name="play_success2" 	type="PLAY_ACTION3" 			successjob="success" 		failjob="gohome" 		time="2"/>
	<job name="success"			type="SET_MATERIAL"				successjob="go_drop"	 	failjob="gohome" 		material="FISH"/>

	<!-- drop it at (5|4) -->
	<job name="go_drop"			type="GO_TO" 					successjob="look" 			failjob="gohome" 		dx="5" dy="4"/>
	<job name="look"		    type="LOOK_AT"  				successjob="drop1"	    	failjob="hide"  		direction="SOUTH_WEST"/>
	<job name="drop1" 			type="DROP" 					successjob="walk1" 			failjob="gohome" 		material="FISH"/>
	<job name="walk1"			type="WALK"						successjob="gohome"			failjob="hide"			direction="WEST"/>

</building>
