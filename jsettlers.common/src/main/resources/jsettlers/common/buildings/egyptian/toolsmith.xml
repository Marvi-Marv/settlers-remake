<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE building SYSTEM "../building.dtd" >
<building worker="SMITH">
    <ground groundtype="GRASS" />
    <ground groundtype="EARTH" />
    <ground groundtype="FLATTENED" />

    <blocked dx="2" dy="2" block="true" />
    <blocked dx="1" dy="1" block="true" />
    <blocked dx="0" dy="0" block="true" />
    <blocked dx="1" dy="2" block="true" />
    <blocked dx="0" dy="1" block="true" />
    <blocked dx="-1" dy="0" block="true" />
    <blocked dx="-3" dy="-1" block="true" />
    <blocked dx="-2" dy="-1" block="true" />
    <blocked dx="-2" dy="0" block="true" />
    <blocked dx="-2" dy="1" block="true" />
    <blocked dx="-3" dy="0" block="true" />
    <blocked dx="-3" dy="-2" block="true" />
    <blocked dx="-2" dy="-2" block="true" />
    <blocked dx="-1" dy="-1" block="true" />
    <blocked dx="1" dy="0" block="true" />
    <blocked dx="2" dy="1" block="true" />
    <blocked dx="3" dy="0" block="true" />
    <blocked dx="2" dy="-1" block="true" />
    <blocked dx="1" dy="-1" block="true" />
    <blocked dx="1" dy="-2" block="true" />
    <blocked dx="0" dy="-2" block="true" />
    <blocked dx="0" dy="-1" block="true" />
    <blocked dx="-1" dy="-2" block="true" />
    <blocked dx="-3" dy="-3" block="true" />
    <blocked dx="-2" dy="-3" block="true" />
    <blocked dx="-1" dy="-3" block="true" />
    <blocked dx="0" dy="-3" block="true" />
    <blocked dx="-2" dy="-4" block="true" />
    <blocked dx="-3" dy="-4" block="true" />
    <blocked dx="-1" dy="-4" block="true" />
    <blocked dx="3" dy="-1" block="true" />
    <blocked dx="2" dy="-2" block="true" />
    <blocked dx="0" dy="-4" block="true" />
    <blocked dx="1" dy="-3" block="true" />
    <blocked dx="3" dy="2" block="true" />
    <blocked dx="-3" dy="1" block="true" />
    <blocked dx="-1" dy="2" block="true" />
    <blocked dx="-1" dy="1" block="true" />
    <blocked dx="2" dy="0" block="true" />
    <blocked dx="0" dy="3" block="true" />
    <blocked dx="1" dy="3" block="true" />
    <blocked dx="0" dy="2" block="true" />
    <blocked dx="2" dy="3" block="true" />
    <blocked dx="3" dy="4" block="true" />
    <blocked dx="2" dy="4" block="true" />
    <blocked dx="0" dy="4" block="true" />
    <blocked dx="1" dy="4" block="true" />
    <blocked dx="-2" dy="2" block="true" />

    <blocked dx="-3" dy="-6" block="false" />
    <blocked dx="-4" dy="-5" block="false" />
    <blocked dx="-4" dy="-4" block="false" />
    <blocked dx="-4" dy="0" block="false" />
    <blocked dx="3" dy="3" block="false" />
    <blocked dx="3" dy="1" block="false" />
    <blocked dx="4" dy="0" block="false" />
    <blocked dx="4" dy="1" block="false" />
    <blocked dx="4" dy="2" block="false" />
    <blocked dx="4" dy="3" block="false" />
    <blocked dx="4" dy="4" block="false" />
    <blocked dx="-2" dy="-6" block="false" />
    <blocked dx="-1" dy="-6" block="false" />
    <blocked dx="0" dy="-5" block="false" />
    <blocked dx="1" dy="-4" block="false" />
    <blocked dx="2" dy="-3" block="false" />
    <blocked dx="3" dy="-2" block="false" />
    <blocked dx="-4" dy="-3" block="false" />
    <blocked dx="-4" dy="-2" block="false" />
    <blocked dx="-4" dy="-1" block="false" />
    <blocked dx="-2" dy="3" block="false" />
    <blocked dx="-3" dy="2" block="false" />
    <blocked dx="-1" dy="4" block="false" />
    <blocked dx="5" dy="2" block="false" />
    <blocked dx="6" dy="3" block="false" />
    <blocked dx="-4" dy="1" block="false" />
    <blocked dx="-3" dy="-5" block="false" />
    <blocked dx="-2" dy="-5" block="false" />
    <blocked dx="-1" dy="-5" block="false" />
    <blocked dx="-4" dy="-6" block="false" />
    <blocked dx="5" dy="3" block="false" />
    <blocked dx="0" dy="5" block="false" />
    <blocked dx="1" dy="5" block="false" />
    <blocked dx="3" dy="5" block="false" />
    <blocked dx="4" dy="5" block="false" />
    <blocked dx="2" dy="5" block="false" />
    <blocked dx="-1" dy="3" block="false" />

    <door dx="3" dy="1" />

    <constructionStack dx="4" dy="3" material="PLANK" buildrequired="2" />
    <constructionStack dx="6" dy="3" material="STONE" buildrequired="6" />
    <requestStack dx="4" dy="1" material="IRON" />
    <requestStack dx="-3" dy="2" material="COAL" />

    <bricklayer dx="-2" dy="3" direction="NORTH_EAST" />
    <bricklayer dx="3" dy="3" direction="NORTH_WEST" />
    <bricklayer dx="4" dy="2" direction="NORTH_WEST" />
    <bricklayer dx="4" dy="1" direction="NORTH_WEST" />

    <flag dx="0" dy="-3" />

    <buildmark dx="3" dy="-1" />
    <buildmark dx="2" dy="-2" />
    <buildmark dx="2" dy="3" />
    <buildmark dx="1" dy="4" />
    <buildmark dx="-3" dy="1" />
    <buildmark dx="-2" dy="-4" />

    <image file="24" for="GUI" type="GUI" sequence="30" image="0" />
    <image file="23" type="SETTLER" for="FINAL" image="0" sequence="10" />
    <image file="23" type="SETTLER" for="BUILD" image="1" sequence="10" />

    <startjob name="go_to_door" />

    <!-- wait at home cycle -->
    <job name="go_to_door" type="GO_TO" dx="3" dy="1" successjob="hide" failjob="hide" />
    <job name="hide" type="HIDE" successjob="waithome" failjob="hide" />
    <job name="waithome" type="WAIT" time="1" successjob="checkhome1" failjob="checkhome1" />
    <job name="checkhome1" type="AVAILABLE" material="IRON" dx="4" dy="1" successjob="checkhome2" failjob="waithome" />
    <job name="checkhome2" type="AVAILABLE" material="COAL" dx="-3" dy="2" successjob="checkhome3" failjob="waithome" />
	<job name="checkhome3" type="NOT_FULL" dx="5" dy="3" successjob="checkhome4" failjob="waithome" />

    <!-- Pop the tool we want to produce. -->
    <job name="checkhome4" type="POP_TOOL" successjob="go_to_coal1" failjob="waithome" />

    <!-- go to the coal stack -->
    <job name="go_to_coal1" type="SHOW"  successjob="go_to_coal2"   failjob="waithome"      direction="SOUTH_EAST" dx="3" dy="1" />
    <job name="go_to_coal2" type="GO_TO" successjob="take_coal1"    failjob="go_to_door" 	dx="-3" dy="2" />

    <job name="take_coal1" type="TAKE" material="COAL" successjob="drop_coal0" failjob="drop_coal1" />

    <job name="drop_coal0" type="WALK" direction="SOUTH_EAST" successjob="drop_coal1" failjob="go_to_door" />
    <job name="drop_coal1" type="WALK" direction="SOUTH_EAST" successjob="drop_coal2" failjob="go_to_door" />
    <job name="drop_coal2" type="GO_TO"  successjob="drop_coal3"  failjob="go_to_door" 	dx="-1" dy="3" />
    <job name="drop_coal3" type="LOOK_AT" direction="NORTH_EAST" successjob="drop_coal4" failjob="go_to_door" />
    <job name="drop_coal4" type="DROP" material="NO_MATERIAL" successjob="go_to_iron0" failjob="go_to_door" />

    <job name="go_to_iron0" type="GO_TO"  successjob="take_iron1"  failjob="go_to_door" 	dx="4" dy="1" />

    <job name="take_iron1" type="TAKE" material="IRON" successjob="go_to_melt1" failjob="go_to_door" />

    <job name="go_to_melt1" type="GO_TO"  successjob="go_to_melt2"  failjob="go_to_door" 	dx="-1" dy="3" />
    <job name="go_to_melt2" type="LOOK_AT" direction="NORTH_EAST" successjob="drop_iron1" failjob="go_to_door" />
    <job name="drop_iron1" type="DROP" material="NO_MATERIAL" successjob="melt" failjob="go_to_door" />

    <job name="melt"	type="BUILDING_ANIMATION"	successjob="drop_iron8" 	failjob="go_to_door" takeMaterialFromMap="false" />

    <job name="drop_iron8" type="TAKE" material="IRON" successjob="go_to_hammer1" failjob="go_to_door" takeMaterialFromMap="false" />
    <job name="go_to_hammer1" type="GO_TO"  successjob="go_to_hammer2"  failjob="go_to_door" 	dx="2" dy="5" />
    <job name="go_to_hammer2" type="LOOK_AT" direction="NORTH_WEST" successjob="hammer0" failjob="go_to_door" />

    <job name="hammer0" type="SET_MATERIAL" material="NO_MATERIAL" successjob="hammer1" failjob="go_to_door" />
    <job name="hammer1" type="PLAY_ACTION1" time=".7" successjob="hammer2" failjob="go_to_door" />
    <job name="hammer2" type="PLAY_ACTION1" time=".7" successjob="hammer3" failjob="go_to_door" />
    <job name="hammer3" type="PLAY_ACTION1" time=".7" successjob="hammer4" failjob="go_to_door" />
    <job name="hammer4" type="PLAY_ACTION1" time=".7" successjob="hammer5" failjob="go_to_door" />
    <job name="hammer5" type="PLAY_ACTION1" time=".7" successjob="go_to_drop1" failjob="go_to_door" />

    <job name="go_to_drop1" type="GO_TO"  successjob="go_to_drop2"  failjob="go_to_door" 	dx="5" dy="3" />
    <job name="go_to_drop2" type="LOOK_AT" direction="NORTH_EAST" successjob="drop1" failjob="go_to_door" />

    <job name="drop1" type="DROP_POPPED" successjob="go_to_door" failjob="go_to_door" />

</building>
